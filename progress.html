<!doctype html><html><head><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><title>Progress</title><link rel="stylesheet" href="styles.css"></head><body><div class="container"><div class="header"><div class="brand">☀️ Progress Pulse</div><div class="nav"><a href="index.html">Dashboard</a><a href="syllabus.html">Syllabus</a><a href="practice.html">Practice</a><a href="calc.html">Calculations</a><a href="progress.html" class="active">Progress</a><a href="tests.html">Tests</a></div></div><main><div class="card"><div class="h1">XP Trend</div><div class="canvas-wrap"><canvas id="xp" width="700" height="140"></canvas></div></div><div class="card"><div class="h1">Maths Trend</div><div class="canvas-wrap"><canvas id="m" width="700" height="120"></canvas></div></div><div class="card"><div class="h1">Physics Trend</div><div class="canvas-wrap"><canvas id="p" width="700" height="120"></canvas></div></div><div class="card"><div class="h1">Chemistry Trend</div><div class="canvas-wrap"><canvas id="c" width="700" height="120"></canvas></div></div><div class="card"><div class="h1">Overall (Total & Percentile)</div><div class="canvas-wrap"><canvas id="overall" width="700" height="160"></canvas></div></div></main></div><script src="https://cdn.jsdelivr.net/npm/chart.js"></script><script src="utils.js"></script><script>
function draw(){ const wk=load(SU.KEYS.WEEK,{}); const xl=Object.keys(wk).slice(-60); const xv=xl.map(d=> wk[d]||0); const ctxx=document.getElementById('xp').getContext('2d'); if(window._xp) window._xp.destroy(); window._xp=new Chart(ctxx,{type:'line',data:{labels:xl.length?xl:['No data'],datasets:[{label:'Daily XP',data:xv,borderColor:'#7C3AED'}]},options:{scales:{y:{beginAtZero:true}}}});
 const tests=load(SU.KEYS.TESTS,[]).slice().sort((a,b)=> (a.t||0)-(b.t||0)); const labels=tests.map(t=> t.name || new Date(t.t).toLocaleDateString()); const m=tests.map(t=> t.m||null); const p=tests.map(t=> t.p||null); const c=tests.map(t=> t.c||null); const total=tests.map(t=> t.total||null); const perc=tests.map(t=> t.perc||null);
 function line(id,data,color,label){ const ctx=document.getElementById(id).getContext('2d'); if(window[id]) window[id].destroy(); window[id]=new Chart(ctx,{type:'line',data:{labels,datasets:[{label:label,data:data,borderColor:color,backgroundColor:color,fill:false}]},options:{scales:{y:{beginAtZero:true, suggestedMax: Math.max(100, (Math.max(...(data.filter(x=>x!=null)||[0]))||100)+10)}}}}); }
 line('m',m,'#7C3AED','Maths'); line('p',p,'#06B6D4','Physics'); line('c',c,'#FFD166','Chemistry');
 const cto=document.getElementById('overall').getContext('2d'); if(window._overall) window._overall.destroy(); window._overall=new Chart(cto,{data:{labels,datasets:[{type:'bar',label:'Total',data:total,backgroundColor:'rgba(124,58,237,0.6)'},{type:'line',label:'Percentile',data:perc,borderColor:'#ffffff',yAxisID:'pct'}]},options:{scales:{y:{beginAtZero:true},pct:{position:'right',min:0,max:100}}}});
}
draw(); window.addEventListener('storage',(e)=>{ if(e.key==='su_tests_updated' || e.key===SU.KEYS.TESTS) draw(); }); setInterval(draw,4000);
</script></body></html>