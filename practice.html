<!doctype html><html><head><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><title>Practice Arena</title><link rel="stylesheet" href="styles.css"></head><body><div class="container"><div class="header"><div class="brand">â˜€ï¸ Practice Arena</div><div class="nav"><a href="index.html">Dashboard</a><a href="syllabus.html">Syllabus</a><a href="practice.html" class="active">Practice</a><a href="calc.html">Calculations</a><a href="progress.html">Progress</a><a href="tests.html">Tests</a></div></div><main><div class="card"><div class="h1">Practice Session</div><div class="small">Start, Stop, Submit; tag results; name sessions; export per session without duplicates.</div><div style="margin-top:8px" class="row"><label class="small">Session Name</label><input id="session-name" class="input" placeholder=""><button id="new-session" class="btn">New Session</button></div><div style="margin-top:8px"><label class="small">Subject</label><select id="sub" class="input"><option>Maths</option><option>Physics</option><option>Chemistry</option></select><label class="small">Topic</label><input id="topic" class="input" placeholder="Topic"><label class="small">Difficulty</label><select id="diff" class="input"><option>Easy</option><option>Medium</option><option>Hard</option><option>Insane</option></select><div style="margin-top:8px" class="row"><button id="start" class="btn">Start</button><button id="stop" class="btn">Stop</button><button id="submit" class="btn">Submit</button><button id="export" class="btn">Export Session</button><button id="clear" class="btn">Clear Logs</button></div><div style="margin-top:12px" class="h1" id="timer">00:00.0</div></div></div><div class="card"><div class="h1">Recent Logs</div><div id="list" class="list small"></div></div></main><div class="footer"></div></div><script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script><script src="utils.js"></script><script>
// Practice logic
let timer=null,start=0,elapsed=0; function fmt(ms){const s=Math.floor(ms/1000);const mm=String(Math.floor(s/60)).padStart(2,'0');const ss=String(s%60).padStart(2,'0');const t=Math.floor(ms%1000/100);return `${mm}:${ss}.${t}`}
function initSessionName(){ const def='Session_'+ new Date().toISOString().slice(0,10) + '_#1'; if(!localStorage.getItem('su_current_session')) localStorage.setItem('su_current_session', def); document.getElementById('session-name').value = localStorage.getItem('su_current_session'); }
initSessionName();
document.getElementById('new-session').addEventListener('click', ()=>{ const name=prompt('New session name', 'Session_'+new Date().toISOString().slice(0,10)+'_#'+Math.floor(Math.random()*100)); if(!name) return; localStorage.setItem('su_current_session', name); document.getElementById('session-name').value=name; alert('Session set to '+name); });

document.getElementById('start').addEventListener('click', ()=>{ if(timer) return; start=Date.now()-elapsed; timer=setInterval(()=>{ elapsed=Date.now()-start; document.getElementById('timer').textContent = fmt(elapsed); },100); });

document.getElementById('stop').addEventListener('click', ()=>{ if(timer) clearInterval(timer); timer=null; });

function calcPoints(time,diff){ const base = diff==='Easy'?5:diff==='Medium'?10:diff==='Hard'?20:40; const mult = diff==='Easy'?1:diff==='Medium'?1.5:diff==='Hard'?2:3; const timePenalty = Math.min(30, Math.floor(time/3)); return Math.max(0, Math.round(base*mult - timePenalty)); }

document.getElementById('submit').addEventListener('click', ()=>{ if(timer) clearInterval(timer); timer=null; const timeSec = Math.round((elapsed||0)/1000); const subj=document.getElementById('sub').value; const topic=document.getElementById('topic').value; const diff=document.getElementById('diff').value; const session = document.getElementById('session-name').value || localStorage.getItem('su_current_session'); const points = calcPoints(timeSec,diff); const entry = {session,subject:subj,topic:topic,diff:diff,time:timeSec,points:points,result:'pending',t:Date.now()}; const arr=load(SU.KEYS.PRACTICE,[]); arr.push(entry); // ensure no duplicates by using unique t value
 save(SU.KEYS.PRACTICE, arr); logPractice(entry); addXP(points,'practice'); alert('Saved +'+points+' XP'); elapsed=0; document.getElementById('timer').textContent='00:00.0'; render(); });

function render(){ const root=document.getElementById('list'); root.innerHTML=''; const arr=load(SU.KEYS.PRACTICE,[]).slice().reverse(); arr.forEach((a,i)=>{ const d=document.createElement('div'); d.className='topic'; d.innerHTML = `<div><strong>${a.subject}${a.topic? ' â€¢ '+a.topic:''}</strong><div class='small'>${a.diff} â€¢ ${a.time}s â€¢ ${new Date(a.t).toLocaleString()}</div></div><div><div class='small'>${a.result}</div><div style='display:flex;gap:6px;margin-top:6px'><button class='btn' data-i='${i}' data-act='correct'>âœ…</button><button class='btn' data-i='${i}' data-act='incorrect'>âŒ</button><button class='btn' data-i='${i}' data-act='na'>âšª</button><button class='btn' data-i='${i}' data-act='del'>ğŸ—‘ï¸</button></div></div>`; root.appendChild(d); }); // handlers
 root.querySelectorAll('button[data-act]').forEach(btn=> btn.addEventListener('click', e=>{ const idx = Number(btn.getAttribute('data-i')); const act = btn.getAttribute('data-act'); const arr = load(SU.KEYS.PRACTICE,[]); const entry = arr[arr.length-1-idx]; if(!entry) return; if(act==='correct'){ entry.result='Correct'; entry.points = Math.max(1, entry.points + Math.round(entry.points*0.2)); save(SU.KEYS.PRACTICE, arr); addXP(Math.round(entry.points*0.2), 'practice_correct'); } else if(act==='incorrect'){ entry.result='Incorrect'; entry.points = 0; save(SU.KEYS.PRACTICE, arr); } else if(act==='na'){ entry.result='Not Attempted'; save(SU.KEYS.PRACTICE, arr); } else if(act==='del'){ if(confirm('Delete this log?')){ arr.splice(arr.length-1-idx,1); save(SU.KEYS.PRACTICE,arr); } } render(); })); }

// export session (no duplicates)
document.getElementById('export').addEventListener('click', ()=>{ const session=document.getElementById('session-name').value||localStorage.getItem('su_current_session'); const all=load(SU.KEYS.PRACTICE,[]); const sel = all.filter(x=> x.session === session); if(!sel.length){ alert('No logs for this session'); return; } // remove duplicates by timestamp
 const seen=setUnique(sel); const ws=[['Date','Session','Subject','Topic','Difficulty','Time(s)','Result','Points']]; seen.forEach(r=> ws.push([ new Date(r.t).toLocaleString(), r.session, r.subject, r.topic||'', r.diff, r.time, r.result, r.points ])); const wb = XLSX.utils.book_new(); const ws1 = XLSX.utils.aoa_to_sheet(ws); XLSX.utils.book_append_sheet(wb, ws1, 'Practice'); const name = 'Sunstrike_Practice_'+ session +'.xlsx'; XLSX.writeFile(wb, name); });

function setUnique(arr){ const map={}; const out=[]; arr.forEach(it=>{ if(!map[it.t]){ map[it.t]=true; out.push(it); } }); return out; }

document.getElementById('clear').addEventListener('click', ()=>{ if(!confirm('Clear all practice logs for ALL sessions?')) return; save(SU.KEYS.PRACTICE,[]); render(); });

render();
</script></body></html>